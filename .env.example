# =============================================================================
# Agent Memory MCP Server Configuration - TEMPLATE
# =============================================================================
# Copy this file to .env and uncomment/modify values as needed.
# Environment variables take precedence over .env file values.
# All values shown are defaults - uncomment and modify to customize.

# =============================================================================
# DATA DIRECTORY (Recommended - single path for all data)
# =============================================================================
# Set this ONE path and all data files (database, vectors, backups, exports,
# logs) will be stored relative to it. This is the recommended approach.
#
# Priority: Individual path env vars > DATA_DIR > projectRoot/data
#
# Supports tilde (~) expansion for home directory paths.
#
# Examples:
#   Development (default): uses projectRoot/data/
#   Production:  AGENT_MEMORY_DATA_DIR=~/.agent-memory
#   Docker:      AGENT_MEMORY_DATA_DIR=/data (with -v ~/.agent-memory:/data)
#
# AGENT_MEMORY_DATA_DIR=~/.agent-memory

# =============================================================================
# DATABASE CONFIGURATION
# =============================================================================

# Path to SQLite database file (overrides DATA_DIR/memory.db)
# Only set this if you need the database in a different location
# AGENT_MEMORY_DB_PATH=/custom/path/memory.db

# Skip automatic database initialization on startup
# Set to '1' to skip (useful for read-only connections)
# AGENT_MEMORY_SKIP_INIT=0

# Development mode: relaxes strict validation for better developer experience
# When enabled, migration checksum mismatches are auto-fixed instead of failing
# Set to '1' to enable (default: 0)
# AGENT_MEMORY_DEV_MODE=0

# Auto-fix migration checksums when mismatches are detected
# Defaults to AGENT_MEMORY_DEV_MODE value if not explicitly set
# Set to '1' to enable, '0' to disable
# AGENT_MEMORY_AUTO_FIX_CHECKSUMS=0

# =============================================================================
# VECTOR DATABASE CONFIGURATION
# =============================================================================

# Path to LanceDB vector database directory (overrides DATA_DIR/vectors.lance)
# Only set this if you need vectors in a different location
# AGENT_MEMORY_VECTOR_DB_PATH=/custom/path/vectors.lance

# Distance metric for vector similarity search
# Options: cosine (default, best for normalized embeddings), l2, dot
# AGENT_MEMORY_DISTANCE_METRIC=cosine

# =============================================================================
# EMBEDDING CONFIGURATION
# =============================================================================

# Embedding provider
# Options: openai, local, disabled
# Default: openai (if API key provided), otherwise local
# AGENT_MEMORY_EMBEDDING_PROVIDER=openai

# OpenAI API key (required for openai provider)
# AGENT_MEMORY_OPENAI_API_KEY=

# OpenAI embedding model name
# AGENT_MEMORY_OPENAI_MODEL=text-embedding-3-small

# =============================================================================
# EXTRACTION CONFIGURATION (LLM-based auto-capture)
# =============================================================================

# Extraction provider for memory_observe tool
# Options: openai, anthropic, ollama, disabled
# Default: openai (if API key provided), anthropic (if key provided), otherwise disabled
# AGENT_MEMORY_EXTRACTION_PROVIDER=openai

# Anthropic API key (required for anthropic provider)
# AGENT_MEMORY_ANTHROPIC_API_KEY=

# Anthropic model name for extraction
# AGENT_MEMORY_EXTRACTION_ANTHROPIC_MODEL=claude-3-5-sonnet-20241022

# OpenAI model name for extraction (different from embedding model)
# AGENT_MEMORY_EXTRACTION_OPENAI_MODEL=gpt-4o-mini

# OpenAI-compatible base URL (for LM Studio, LocalAI, or other compatible APIs)
# LM Studio: http://localhost:1234/v1
# LocalAI:   http://localhost:8080/v1
# AGENT_MEMORY_EXTRACTION_OPENAI_BASE_URL=http://localhost:1234/v1

# Enforce base URL allowlist (block non-allowed hosts)
# Set to 'true' for production security, 'false' for development flexibility
# AGENT_MEMORY_EXTRACTION_STRICT_ALLOWLIST=false

# Ollama configuration (for local LLM extraction)
# AGENT_MEMORY_OLLAMA_BASE_URL=http://localhost:11434
# AGENT_MEMORY_OLLAMA_MODEL=llama3.2

# Maximum tokens for extraction response
# AGENT_MEMORY_EXTRACTION_MAX_TOKENS=4096

# Temperature for extraction (lower = more deterministic)
# AGENT_MEMORY_EXTRACTION_TEMPERATURE=0.2

# Minimum confidence threshold for auto-storing extracted entries (0-1)
# AGENT_MEMORY_EXTRACTION_CONFIDENCE_THRESHOLD=0.7

# =============================================================================
# LOGGING CONFIGURATION
# =============================================================================

# Log level
# Options: fatal, error, warn, info, debug, trace
# LOG_LEVEL=info

# Enable debug logging to log directory (DATA_DIR/logs/agent-memory-debug.log)
# Set to '1' to enable
# AGENT_MEMORY_DEBUG=0

# Enable performance/verbose logging
# Set to '1' to enable
# AGENT_MEMORY_PERF=0

# Node environment (affects pretty printing in development)
# NODE_ENV=development

# =============================================================================
# CACHE CONFIGURATION
# =============================================================================

# Total memory limit for all caches (MB)
# AGENT_MEMORY_CACHE_LIMIT_MB=100

# Query result cache TTL (milliseconds)
# Default: 300000 (5 minutes)
# AGENT_MEMORY_QUERY_CACHE_TTL_MS=300000

# Scope chain cache TTL (milliseconds)
# Default: 600000 (10 minutes)
# AGENT_MEMORY_SCOPE_CACHE_TTL_MS=600000

# Maximum prepared statements to cache
# AGENT_MEMORY_MAX_PREPARED_STATEMENTS=100

# Query cache maximum size (entries)
# AGENT_MEMORY_QUERY_CACHE_SIZE=200

# Query cache maximum memory (MB)
# AGENT_MEMORY_QUERY_CACHE_MEMORY_MB=50

# Cache memory pressure threshold (0-1)
# Eviction starts when cache memory exceeds this percentage of limit
# AGENT_MEMORY_CACHE_PRESSURE_THRESHOLD=0.8

# Cache eviction target (0-1)
# Eviction continues until memory drops to this percentage of limit
# AGENT_MEMORY_CACHE_EVICTION_TARGET=0.8

# =============================================================================
# MEMORY MANAGEMENT
# =============================================================================

# Heap memory pressure threshold (0-1)
# Caches proactively evict when heap usage exceeds this percentage
# AGENT_MEMORY_HEAP_PRESSURE_THRESHOLD=0.85

# Memory coordinator check interval (milliseconds)
# AGENT_MEMORY_MEMORY_CHECK_INTERVAL_MS=30000

# =============================================================================
# RATE LIMITING
# =============================================================================

# Enable/disable rate limiting
# Set to '0' to disable all rate limiting
# AGENT_MEMORY_RATE_LIMIT=1

# Per-agent rate limit
# AGENT_MEMORY_RATE_LIMIT_PER_AGENT_MAX=100
# AGENT_MEMORY_RATE_LIMIT_PER_AGENT_WINDOW_MS=60000

# Global rate limit (across all agents)
# AGENT_MEMORY_RATE_LIMIT_GLOBAL_MAX=1000
# AGENT_MEMORY_RATE_LIMIT_GLOBAL_WINDOW_MS=60000

# Burst rate limit (short window protection)
# AGENT_MEMORY_RATE_LIMIT_BURST_MAX=20
# AGENT_MEMORY_RATE_LIMIT_BURST_WINDOW_MS=1000

# =============================================================================
# SEMANTIC SEARCH CONFIGURATION
# =============================================================================

# Default semantic similarity threshold (0-1)
# Results below this threshold are filtered out
# AGENT_MEMORY_SEMANTIC_THRESHOLD=0.7

# Weight given to semantic score in hybrid scoring (0-1)
# AGENT_MEMORY_SEMANTIC_SCORE_WEIGHT=0.7

# Similarity threshold for duplicate detection (0-1)
# AGENT_MEMORY_DUPLICATE_THRESHOLD=0.8

# =============================================================================
# RECENCY/DECAY SCORING
# =============================================================================

# Decay half-life in days (entries lose half their recency score after this period)
# Default: 14 (two weeks)
# AGENT_MEMORY_DECAY_HALF_LIFE_DAYS=14

# Default weight for recency in scoring (0-1)
# Higher values give more importance to recently created/updated entries
# AGENT_MEMORY_RECENCY_WEIGHT=0.5

# Maximum recency boost added to score
# AGENT_MEMORY_MAX_RECENCY_BOOST=2.0

# Use version updatedAt timestamp instead of entry createdAt
# Set to '1' to prefer updated time (default), '0' for created time only
# AGENT_MEMORY_USE_UPDATED_AT=1

# =============================================================================
# VALIDATION LIMITS
# =============================================================================

# Text field maximum lengths (characters)
# AGENT_MEMORY_NAME_MAX_LENGTH=500
# AGENT_MEMORY_TITLE_MAX_LENGTH=1000
# AGENT_MEMORY_DESCRIPTION_MAX_LENGTH=10000
# AGENT_MEMORY_CONTENT_MAX_LENGTH=100000
# AGENT_MEMORY_RATIONALE_MAX_LENGTH=5000

# JSON field maximum sizes (bytes when serialized)
# AGENT_MEMORY_METADATA_MAX_BYTES=50000
# AGENT_MEMORY_PARAMETERS_MAX_BYTES=50000
# AGENT_MEMORY_EXAMPLES_MAX_BYTES=100000

# Array limits
# AGENT_MEMORY_TAGS_MAX_COUNT=50
# AGENT_MEMORY_EXAMPLES_MAX_COUNT=20
# AGENT_MEMORY_BULK_OPERATION_MAX=100

# =============================================================================
# PAGINATION
# =============================================================================

# Default query result limit
# AGENT_MEMORY_DEFAULT_QUERY_LIMIT=20

# Maximum query result limit
# AGENT_MEMORY_MAX_QUERY_LIMIT=100

# =============================================================================
# HEALTH CHECK & RECONNECTION
# =============================================================================

# Health check interval (milliseconds)
# AGENT_MEMORY_HEALTH_CHECK_INTERVAL_MS=30000

# Maximum reconnection attempts
# AGENT_MEMORY_MAX_RECONNECT_ATTEMPTS=3

# Reconnection base delay (milliseconds)
# AGENT_MEMORY_RECONNECT_BASE_DELAY_MS=1000

# Reconnection maximum delay (milliseconds)
# AGENT_MEMORY_RECONNECT_MAX_DELAY_MS=5000

# =============================================================================
# RETRY CONFIGURATION
# =============================================================================

# Maximum retry attempts
# AGENT_MEMORY_RETRY_MAX_ATTEMPTS=3

# Initial retry delay (milliseconds)
# AGENT_MEMORY_RETRY_INITIAL_DELAY_MS=100

# Maximum retry delay (milliseconds)
# AGENT_MEMORY_RETRY_MAX_DELAY_MS=5000

# Retry backoff multiplier
# AGENT_MEMORY_RETRY_BACKOFF_MULTIPLIER=2

# =============================================================================
# CONFLICT DETECTION
# =============================================================================

# Time window for conflict detection (milliseconds)
# AGENT_MEMORY_CONFLICT_WINDOW_MS=5000

# High error correlation threshold (0-1)
# AGENT_MEMORY_HIGH_ERROR_CORRELATION_THRESHOLD=0.7

# =============================================================================
# TIMESTAMP DISPLAY
# =============================================================================

# Display timezone for timestamps in responses
# Options: 'local' (system timezone), 'utc', or IANA timezone (e.g., 'Europe/Rome')
# Timestamps are always stored in UTC; this only affects display
# AGENT_MEMORY_TIMEZONE=local

# =============================================================================
# DIRECTORY PATHS (Optional overrides)
# =============================================================================
# These are all relative to AGENT_MEMORY_DATA_DIR by default.
# Only set individual paths if you need them in different locations.

# Path to backup directory (overrides DATA_DIR/backups)
# AGENT_MEMORY_BACKUP_PATH=/custom/path/backups

# Path to export directory (overrides DATA_DIR/exports)
# AGENT_MEMORY_EXPORT_PATH=/custom/path/exports

# Path to log directory (overrides DATA_DIR/logs)
# AGENT_MEMORY_LOG_PATH=/custom/path/logs

# =============================================================================
# REST API CONFIGURATION
# =============================================================================

# Enable REST API server
# Default: false (disabled for security)
# Set to 'true' to enable the REST API server
# AGENT_MEMORY_REST_ENABLED=false

# REST API server host
# Default: 127.0.0.1 (localhost only)
# Set to 0.0.0.0 to allow external connections
# AGENT_MEMORY_REST_HOST=127.0.0.1

# REST API server port
# Default: 8787
# AGENT_MEMORY_REST_PORT=8787

# REST API authentication key
# Required when REST is enabled (unless auth is disabled)
# Requests must include: Authorization: Bearer <key> or X-API-Key: <key>
# AGENT_MEMORY_REST_API_KEY=your-secret-key-here

# Disable REST API authentication (for local development only)
# WARNING: Do not use in production or shared environments
# AGENT_MEMORY_REST_AUTH_DISABLED=false

# =============================================================================
# PERMISSIONS & SECURITY
# =============================================================================

# Permissions mode
# Default: (not set) - secure by default, denies access when no permissions configured
# Set to 'permissive' to allow all agents full access when no permissions are configured
# This is useful for single-agent setups or development environments
# AGENT_MEMORY_PERMISSIONS_MODE=permissive

# Admin key for protected operations (backup, reset, permissions)
# AGENT_MEMORY_ADMIN_KEY=your-admin-key-here

# =============================================================================
# DATABASE TYPE
# =============================================================================

# Database backend: sqlite (default) or postgresql (enterprise)
# AGENT_MEMORY_DB_TYPE=sqlite

# =============================================================================
# POSTGRESQL CONFIGURATION (when DB_TYPE=postgresql)
# =============================================================================

# PostgreSQL server hostname
# AGENT_MEMORY_PG_HOST=localhost

# PostgreSQL server port
# AGENT_MEMORY_PG_PORT=5432

# PostgreSQL database name
# AGENT_MEMORY_PG_DATABASE=agent_memory

# PostgreSQL username
# AGENT_MEMORY_PG_USER=postgres

# PostgreSQL password
# AGENT_MEMORY_PG_PASSWORD=

# Enable SSL/TLS for PostgreSQL connections
# AGENT_MEMORY_PG_SSL=false

# Connection pool settings
# AGENT_MEMORY_PG_POOL_MIN=2
# AGENT_MEMORY_PG_POOL_MAX=10
# AGENT_MEMORY_PG_IDLE_TIMEOUT_MS=30000
# AGENT_MEMORY_PG_CONNECTION_TIMEOUT_MS=10000
# AGENT_MEMORY_PG_STATEMENT_TIMEOUT_MS=30000

# =============================================================================
# REDIS CONFIGURATION (for distributed deployments)
# =============================================================================

# Enable Redis for distributed caching, locking, and events
# AGENT_MEMORY_REDIS_ENABLED=false

# Redis connection URL (overrides host/port if set)
# AGENT_MEMORY_REDIS_URL=redis://localhost:6379

# Redis server hostname
# AGENT_MEMORY_REDIS_HOST=localhost

# Redis server port
# AGENT_MEMORY_REDIS_PORT=6379

# Redis password
# AGENT_MEMORY_REDIS_PASSWORD=

# Redis database number
# AGENT_MEMORY_REDIS_DB=0

# Enable TLS/SSL for Redis connections
# AGENT_MEMORY_REDIS_TLS=false

# Key prefix for namespacing Redis keys
# AGENT_MEMORY_REDIS_KEY_PREFIX=agentmem:

# Cache TTL in milliseconds (default: 1 hour)
# AGENT_MEMORY_REDIS_CACHE_TTL_MS=3600000

# Lock TTL in milliseconds (default: 30 seconds)
# AGENT_MEMORY_REDIS_LOCK_TTL_MS=30000

# Lock acquisition retry settings
# AGENT_MEMORY_REDIS_LOCK_RETRY_COUNT=3
# AGENT_MEMORY_REDIS_LOCK_RETRY_DELAY_MS=200

# Pub/sub channel for events
# AGENT_MEMORY_REDIS_EVENT_CHANNEL=agentmem:events

# Connection timeout in milliseconds
# AGENT_MEMORY_REDIS_CONNECT_TIMEOUT_MS=10000

# Maximum retries per Redis request
# AGENT_MEMORY_REDIS_MAX_RETRIES=3

# =============================================================================
# BACKUP SCHEDULER
# =============================================================================

# Enable backup scheduler
# Defaults to true if schedule is set
# AGENT_MEMORY_BACKUP_ENABLED=false

# Cron expression for scheduled backups
# Examples: "0 0 * * *" (daily at midnight), "0 */6 * * *" (every 6 hours)
# AGENT_MEMORY_BACKUP_SCHEDULE=

# Number of backups to retain
# AGENT_MEMORY_BACKUP_RETENTION=5

# =============================================================================
# SCORING WEIGHTS
# =============================================================================

# Weights for different scoring factors in search results

# Weight for explicit relations between entries
# AGENT_MEMORY_WEIGHT_EXPLICIT_RELATION=5

# Weight for matching tags
# AGENT_MEMORY_WEIGHT_TAG_MATCH=3

# Weight for scope proximity
# AGENT_MEMORY_WEIGHT_SCOPE_PROXIMITY=2

# Weight for text matching
# AGENT_MEMORY_WEIGHT_TEXT_MATCH=1

# Maximum contribution from priority score
# AGENT_MEMORY_WEIGHT_PRIORITY_MAX=10

# Maximum contribution from semantic similarity
# AGENT_MEMORY_WEIGHT_SEMANTIC_MAX=5

# Maximum contribution from recency
# AGENT_MEMORY_WEIGHT_RECENCY_MAX=2

# =============================================================================
# TRANSACTION CONFIGURATION
# =============================================================================

# Maximum retries for transaction conflicts
# AGENT_MEMORY_TRANSACTION_MAX_RETRIES=3

# Initial delay between transaction retries (milliseconds)
# AGENT_MEMORY_TRANSACTION_INITIAL_DELAY_MS=50

# Maximum delay between transaction retries (milliseconds)
# AGENT_MEMORY_TRANSACTION_MAX_DELAY_MS=500

# Backoff multiplier for transaction retries
# AGENT_MEMORY_TRANSACTION_BACKOFF_MULTIPLIER=2

# =============================================================================
# OUTPUT FORMAT
# =============================================================================

# Response output format: 'json' (default) or 'compact' (human-readable)
# AGENT_MEMORY_OUTPUT_FORMAT=json
