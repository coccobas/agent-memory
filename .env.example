# =============================================================================
# Agent Memory MCP Server Configuration
# =============================================================================
# Copy this file to .env and modify values as needed.
# Environment variables take precedence over .env file values.
# All values shown are defaults - uncomment and modify to customize.

# =============================================================================
# SHARED DATABASE CONFIGURATION (Recommended for multi-IDE setups)
# =============================================================================
# To share database between npm and Docker installations across IDEs (Cursor,
# Claude Code, etc.), use an absolute path in your home directory:
#
# AGENT_MEMORY_DB_PATH=~/.agent-memory/memory.db
# AGENT_MEMORY_VECTOR_DB_PATH=~/.agent-memory/vectors.lance
#
# The tilde (~) is expanded automatically. The directory will be created
# on first run. Both npm and Docker installations can share the same paths.
#
# For Docker: Use bind mount in MCP config:
#   -v /Users/yourname/.agent-memory:/data
# The container always uses /data/memory.db internally.

# =============================================================================
# DATABASE CONFIGURATION
# =============================================================================

# Path to SQLite database file (absolute or relative to project root)
# Supports tilde (~) expansion for home directory paths
# AGENT_MEMORY_DB_PATH=data/memory.db

# Skip automatic database initialization on startup
# Set to '1' to skip (useful for read-only connections)
# AGENT_MEMORY_SKIP_INIT=0

# =============================================================================
# VECTOR DATABASE CONFIGURATION
# =============================================================================

# Path to LanceDB vector database directory
# AGENT_MEMORY_VECTOR_DB_PATH=data/vectors.lance

# Distance metric for vector similarity search
# Options: cosine (default, best for normalized embeddings), l2, dot
# AGENT_MEMORY_DISTANCE_METRIC=cosine

# =============================================================================
# EMBEDDING CONFIGURATION
# =============================================================================

# Embedding provider
# Options: openai, local, disabled
# Default: openai (if API key provided), otherwise local
# AGENT_MEMORY_EMBEDDING_PROVIDER=openai

# OpenAI API key (required for openai provider)
# AGENT_MEMORY_OPENAI_API_KEY=

# OpenAI embedding model name
# AGENT_MEMORY_OPENAI_MODEL=text-embedding-3-small

# =============================================================================
# LOGGING CONFIGURATION
# =============================================================================

# Log level
# Options: fatal, error, warn, info, debug, trace
# LOG_LEVEL=info

# Enable debug logging to temp file (/tmp/agent-memory-debug.log)
# Set to '1' to enable
# AGENT_MEMORY_DEBUG=0

# Enable performance/verbose logging
# Set to '1' to enable
# AGENT_MEMORY_PERF=0

# Node environment (affects pretty printing in development)
# NODE_ENV=development

# =============================================================================
# CACHE CONFIGURATION
# =============================================================================

# Total memory limit for all caches (MB)
# AGENT_MEMORY_CACHE_LIMIT_MB=100

# Query result cache TTL (milliseconds)
# Default: 300000 (5 minutes)
# AGENT_MEMORY_QUERY_CACHE_TTL_MS=300000

# Scope chain cache TTL (milliseconds)
# Default: 600000 (10 minutes)
# AGENT_MEMORY_SCOPE_CACHE_TTL_MS=600000

# Maximum prepared statements to cache
# AGENT_MEMORY_MAX_PREPARED_STATEMENTS=100

# Query cache maximum size (entries)
# AGENT_MEMORY_QUERY_CACHE_SIZE=200

# Query cache maximum memory (MB)
# AGENT_MEMORY_QUERY_CACHE_MEMORY_MB=50

# Cache memory pressure threshold (0-1)
# Eviction starts when cache memory exceeds this percentage of limit
# AGENT_MEMORY_CACHE_PRESSURE_THRESHOLD=0.8

# Cache eviction target (0-1)
# Eviction continues until memory drops to this percentage of limit
# AGENT_MEMORY_CACHE_EVICTION_TARGET=0.8

# =============================================================================
# MEMORY MANAGEMENT
# =============================================================================

# Heap memory pressure threshold (0-1)
# Caches proactively evict when heap usage exceeds this percentage
# AGENT_MEMORY_HEAP_PRESSURE_THRESHOLD=0.85

# Memory coordinator check interval (milliseconds)
# AGENT_MEMORY_MEMORY_CHECK_INTERVAL_MS=30000

# =============================================================================
# RATE LIMITING
# =============================================================================

# Enable/disable rate limiting
# Set to '0' to disable all rate limiting
# AGENT_MEMORY_RATE_LIMIT=1

# Per-agent rate limit
# AGENT_MEMORY_RATE_LIMIT_PER_AGENT_MAX=100
# AGENT_MEMORY_RATE_LIMIT_PER_AGENT_WINDOW_MS=60000

# Global rate limit (across all agents)
# AGENT_MEMORY_RATE_LIMIT_GLOBAL_MAX=1000
# AGENT_MEMORY_RATE_LIMIT_GLOBAL_WINDOW_MS=60000

# Burst rate limit (short window protection)
# AGENT_MEMORY_RATE_LIMIT_BURST_MAX=20
# AGENT_MEMORY_RATE_LIMIT_BURST_WINDOW_MS=1000

# =============================================================================
# SEMANTIC SEARCH CONFIGURATION
# =============================================================================

# Default semantic similarity threshold (0-1)
# Results below this threshold are filtered out
# AGENT_MEMORY_SEMANTIC_THRESHOLD=0.7

# Weight given to semantic score in hybrid scoring (0-1)
# AGENT_MEMORY_SEMANTIC_SCORE_WEIGHT=0.7

# Similarity threshold for duplicate detection (0-1)
# AGENT_MEMORY_DUPLICATE_THRESHOLD=0.8

# =============================================================================
# VALIDATION LIMITS
# =============================================================================

# Text field maximum lengths (characters)
# AGENT_MEMORY_NAME_MAX_LENGTH=500
# AGENT_MEMORY_TITLE_MAX_LENGTH=1000
# AGENT_MEMORY_DESCRIPTION_MAX_LENGTH=10000
# AGENT_MEMORY_CONTENT_MAX_LENGTH=100000
# AGENT_MEMORY_RATIONALE_MAX_LENGTH=5000

# JSON field maximum sizes (bytes when serialized)
# AGENT_MEMORY_METADATA_MAX_BYTES=50000
# AGENT_MEMORY_PARAMETERS_MAX_BYTES=50000
# AGENT_MEMORY_EXAMPLES_MAX_BYTES=100000

# Array limits
# AGENT_MEMORY_TAGS_MAX_COUNT=50
# AGENT_MEMORY_EXAMPLES_MAX_COUNT=20
# AGENT_MEMORY_BULK_OPERATION_MAX=100

# =============================================================================
# PAGINATION
# =============================================================================

# Default query result limit
# AGENT_MEMORY_DEFAULT_QUERY_LIMIT=20

# Maximum query result limit
# AGENT_MEMORY_MAX_QUERY_LIMIT=100

# =============================================================================
# HEALTH CHECK & RECONNECTION
# =============================================================================

# Health check interval (milliseconds)
# AGENT_MEMORY_HEALTH_CHECK_INTERVAL_MS=30000

# Maximum reconnection attempts
# AGENT_MEMORY_MAX_RECONNECT_ATTEMPTS=3

# Reconnection base delay (milliseconds)
# AGENT_MEMORY_RECONNECT_BASE_DELAY_MS=1000

# Reconnection maximum delay (milliseconds)
# AGENT_MEMORY_RECONNECT_MAX_DELAY_MS=5000

# =============================================================================
# RETRY CONFIGURATION
# =============================================================================

# Maximum retry attempts
# AGENT_MEMORY_RETRY_MAX_ATTEMPTS=3

# Initial retry delay (milliseconds)
# AGENT_MEMORY_RETRY_INITIAL_DELAY_MS=100

# Maximum retry delay (milliseconds)
# AGENT_MEMORY_RETRY_MAX_DELAY_MS=5000

# Retry backoff multiplier
# AGENT_MEMORY_RETRY_BACKOFF_MULTIPLIER=2

# =============================================================================
# CONFLICT DETECTION
# =============================================================================

# Time window for conflict detection (milliseconds)
# AGENT_MEMORY_CONFLICT_WINDOW_MS=5000

# High error correlation threshold (0-1)
# AGENT_MEMORY_HIGH_ERROR_CORRELATION_THRESHOLD=0.7

# =============================================================================
# TIMESTAMP DISPLAY
# =============================================================================

# Display timezone for timestamps in responses
# Options: 'local' (system timezone), 'utc', or IANA timezone (e.g., 'Europe/Rome')
# Timestamps are always stored in UTC; this only affects display
# AGENT_MEMORY_TIMEZONE=local
